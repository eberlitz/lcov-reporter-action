# Lcov reporter action

This action comments a pull request with a HTML test coverage report.

The report is based on the lcov coverage report generated by your test runner.

Note that this action does not run any tests, but instead expects the tests to have been run
by another action already.


## Example output

Coverage after merging <b>feat/test</b> into <b>master</b><table><tbody><tr><th><b>71.63</b></th></tr></tbody></table>

<details><summary>Coverage Report</summary><table><tbody><tr><th>File</th><th>% Stmts</th><th>% Branches</th><th>% Funcs</th><th>% Lines</th></tr><tr><td colspan='6'><b>src</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/cli.js'>cli.js</a></td><td><b>0</b></td><td><b>0</b></td><td><b>0</b></td><td><b>0</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/comment.js'>comment.js</a></td><td><b>73.33</b></td><td><b>66.67</b></td><td><b>100</b></td><td><b>75</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/html.js'>html.js</a></td><td><b>100</b></td><td><b>100</b></td><td><b>100</b></td><td><b>100</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/index.js'>index.js</a></td><td><b>0</b></td><td><b>0</b></td><td><b>0</b></td><td><b>0</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/lcov.js'>lcov.js</a></td><td><b>100</b></td><td><b>100</b></td><td><b>100</b></td><td><b>100</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/report.js'>report.js</a></td><td><b>94.12</b></td><td><b>82.05</b></td><td><b>100</b></td><td><b>98.61</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/tabulate.js'>tabulate.js</a></td><td><b>97.27</b></td><td><b>95.92</b></td><td><b>100</b></td><td><b>97.96</b></td></tr></tbody></table></details>

## Example output with `base-lcov`, `show-color-emoji`, `show-increase-per-files`

Coverage after merging <b>feat/test</b> into <b>master</b><table><tbody><tr><th><b>60.10</b></th><th>(+30.54) 游릭</th></tr></tbody></table>

<details><summary>Coverage Report</summary><table><tbody><tr><th>File</th><th>% Stmts</th><th>% Branches</th><th>% Funcs</th><th>% Lines</th></tr><tr><td colspan='6'><b>src</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/lcov.js'>lcov.js</a></td><td><b>0</b>(-100) 游댮</td><td><b>0</b>(-100) 游댮</td><td><b>0</b>(-100) 游댮</td><td><b>0</b>(-100) 游댮</td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/report.js'>report.js</a></td><td><b>94.12</b>(+94.12) 游릭</td><td><b>82.05</b>(+82.05) 游릭</td><td><b>100</b>(+100) 游릭</td><td><b>98.61</b>(+98.61) 游릭</td></tr></tbody></table></details>


## Example output using `base-lcov` with all other options enabled

Coverage after merging <b>feat/test</b> into <b>master</b><table><tbody><tr><th><del>29.56</del> <b>60.10</b></th><th>(+30.54) 游릭</th></tr></tbody></table>

<details><summary>Coverage Report</summary><table><tbody><tr><th>File</th><th>% Stmts</th><th>% Branches</th><th>% Funcs</th><th>% Lines</th><th>Uncovered Lines</th></tr><tr><td colspan='6'><b>src</b></td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/lcov.js'>lcov.js</a></td><td><del>100</del> <b>0</b>(-100) 游댮</td><td><del>100</del> <b>0</b>(-100) 游댮</td><td><del>100</del> <b>0</b>(-100) 游댮</td><td><del>100</del> <b>0</b>(-100) 游댮</td><td>5&ndash;9, 11</td></tr><tr><td>&nbsp; &nbsp;<a href='https://github.com/example/foo/blob/f9d42291812ed03bb197e48050ac38ac6befe4e5/src/report.js'>report.js</a></td><td><del>N/A</del> <b>94.12</b>(+94.12) 游릭</td><td><del>N/A</del> <b>82.05</b>(+82.05) 游릭</td><td><del>N/A</del> <b>100</b>(+100) 游릭</td><td><del>N/A</del> <b>98.61</b>(+98.61) 游릭</td><td>11, 53, 83&ndash;84, 139&ndash;140, 153, 157</td></tr></tbody></table></details>


## Inputs

##### `github-token` (**Required**)
Github token used for posting the comment. To use the key provided by the GitHub
action runner, use `${{ secrets.GITHUB_TOKEN }}`.

##### `lcov-file` (**Optional**)
The location of the lcov file to read the coverage report from. Defaults to
`./coverage/lcov.info`.

##### `lcov-base` (**Optional**)
The location of the lcov file resulting from running the tests in the base
branch. When this is set a diff of the coverage percentages is shown.

##### `show-uncovered-lines` (**Optional**)
When set to `true` will show the **uncovered lines** column. **Defaults** to `false`;
##### `show-color-emoji` (**Optional**)
When set to true will show a colored emoji if the coverage decreased 游댮  or increased 游릭, like "<b>98.61</b>(+2.61) 游릭 ". **Defaults** to `true`;

##### `show-old-value-for-files` (**Optional**)
When set to true will show the old coverage result value, like: "<del>94,65</del> <b>98.61</b>". **Defaults** to `false`;

##### `show-increase-per-files` (**Optional**)
When set to true will show the increase/decrease difference of the coverage, like: "<b>98.61</b>(+2.61)". **Defaults** to `true`;


## Example usage

```yml
uses: eberlitz/lcov-reporter-action@v0.2.27
with:
  github-token: ${{ secrets.GITHUB_TOKEN }}
  lcov-file: ./coverage/lcov.info
  base-file: ./coverage/base-lcov.info
  show-uncovered-lines: false
  show-color-emoji: true
  show-old-value-for-files: false
  show-increase-per-files: true
```

## Acknowledgements

The initial code is based on [romeovs/lcov-reporter-action](https://github.com/romeovs/lcov-reporter-action) which was previously based on [ziishaned/jest-reporter-action](https://github.com/ziishaned/jest-reporter-action). I also got some ideas from [hrgui/lcov-reporter-action](https://github.com/hrgui/lcov-reporter-action);
